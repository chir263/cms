<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CodeSandBox</title>
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../../images/favicon.ico"
    />
    <style>
      * {
        margin: 0;
        overflow-y: hidden;
        overflow-x: hidden;
      }
    </style>
  </head>
  <body>
    <iframe id="frame" style="width: 100%; height: 100vh"></iframe>
    <script>
      var para = new URLSearchParams(window.location.search);
      const ORGANISATION_NAME = para.get("ORGANISATION_NAME");
      const EXPERIMENT = para.get("EXPERIMENT");
      var iframe = document.getElementById("frame");
      iframe.src = `https://codesandbox.io/s/github/${ORGANISATION_NAME}/${EXPERIMENT}/main`;

      // var iframe = document.getElementById("your-iframe-id");
      iframe.addEventListener("load", function () {
        var iframeWindow = iframe.contentWindow;

        // Step 1: Click on the "Sign in" button within the iframe
        var signInButton = findButtonByText(
          iframeWindow.document,
          "button",
          "Sign In"
        );
        if (signInButton) signInButton.click();
        else {
          console.log("erroe");
          return;
        }

        // Step 2: Check for the presence of the modal pane at regular intervals
        var interval = setInterval(function () {
          // Step 3: Click on the "Sign in with GitHub" button in the modal pane
          var githubButton = findButtonByText(
            iframeWindow.document,
            "span",
            "Sign in with GitHub"
          );
          if (githubButton) {
            clearInterval(interval); // Stop the interval once the modal pane is found
            githubButton.click();
          }
        }, 100); // Adjust the interval duration if needed
      });

      function findButtonByText(document, tag, buttonText) {
        var buttons = document.getElementsByTagName(tag);
        for (var i = 0; i < buttons.length; i++) {
          if (buttons[i].textContent.trim() === buttonText) {
            return buttons[i];
          }
        }
        return null;
      }
    </script>
  </body>
</html>
